{"version":3,"file":"liq-integrations.js","sources":["../src/handlers/server/plugins/integrations/add.mjs","../src/handlers/server/plugins/integrations/details.mjs","../src/handlers/server/plugins/integrations/list.mjs","../src/handlers/server/plugins/integrations/remove.mjs","../src/handlers/server/plugins/integrations/index.mjs","../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../node_modules/@babel/runtime/helpers/esm/classPrivateFieldGet.js","../node_modules/@babel/runtime/helpers/esm/classExtractFieldDescriptor.js","../node_modules/@babel/runtime/helpers/esm/classApplyDescriptorGet.js","../src/integrations-manager.mjs","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../src/index.js","../src/setup.mjs"],"sourcesContent":["import * as fsPath from 'path'\n\nimport { LIQ_HOME } from '@liquid-labs/liq-defaults'\nimport { addPluginsHandler, addPluginsSetup } from '@liquid-labs/liq-plugins-lib'\n\nconst hostVersionRetriever = ({ app }) => app.ext.serverVersion\n\nconst pluginType = 'integrations'\nconst pluginsDesc = 'integrations'\n\nconst { help, method, parameters } =\n  addPluginsSetup({ hostVersionRetriever, pluginsDesc, pluginType })\n\nconst path = ['server', 'plugins', 'integrations', 'add']\n\nconst installedPluginsRetriever = ({ app }) => app.ext.integrations.listPlugins()\nconst pluginPkgDirRetriever = fsPath.join(LIQ_HOME, 'plugins', 'integrations')\n\nconst func = addPluginsHandler({\n  hostVersionRetriever,\n  installedPluginsRetriever,\n  pluginsDesc,\n  pluginPkgDirRetriever,\n  pluginType\n})\n\nexport { func, help, method, parameters, path }\n","import { detailsPluginHandler, detailsPluginSetup } from '@liquid-labs/liq-plugins-lib'\n\nconst { help, method, parameters } = detailsPluginSetup({ pluginsDesc : 'integrations' })\n\nconst path = ['server', 'plugins', 'integrations', ':integrationPluginName', 'details']\n\nconst installedPluginsRetriever = ({ app }) => app.ext.integrations.listPlugins()\n\nconst func = detailsPluginHandler({ installedPluginsRetriever })\n\nexport { func, help, method, parameters, path }\n","import { listPluginsHandler, listPluginsSetup } from '@liquid-labs/liq-plugins-lib'\n\nconst { help, method, parameters } = listPluginsSetup({ pluginsDesc : 'sever endpoint' })\n\nconst path = ['server', 'plugins', 'integrations', 'list']\n\nconst installedPluginsRetriever = ({ app }) => app.ext.integrations.listPlugins()\nconst hostVersionRetriever = ({ app }) => app.ext.serverVersion\n\nconst func = listPluginsHandler({ hostVersionRetriever, installedPluginsRetriever, pluginType : 'integrations' })\n\nexport { func, help, method, parameters, path }\n","import * as fsPath from 'path'\n\nimport { LIQ_HOME } from '@liquid-labs/liq-defaults'\nimport { removePluginsHandler, removePluginsSetup } from '@liquid-labs/liq-plugins-lib'\n\nconst { help, method, parameters } = removePluginsSetup({ pluginsDesc : 'sever endpoint' })\n\nconst path = ['server', 'plugins', 'integrations', ':integrationPluginName', 'remove']\n\nconst installedPluginsRetriever = ({ app }) => app.ext.integrations.listPlugins()\nconst pluginPkgDirRetriever = fsPath.join(LIQ_HOME, 'plugins', 'integrations')\n\nconst func = removePluginsHandler({\n  installedPluginsRetriever,\n  nameKey    : 'handlerPluginName',\n  pluginPkgDirRetriever\n})\n\nexport { func, help, method, parameters, path }\n","import * as addHandler from './add'\nimport * as detailsHandler from './details'\nimport * as listHandler from './list'\nimport * as removeHandler from './remove'\n\nconst handlers = [addHandler, detailsHandler, listHandler, removeHandler]\n\nexport { handlers }\n","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import classApplyDescriptorGet from \"./classApplyDescriptorGet.js\";\nimport classExtractFieldDescriptor from \"./classExtractFieldDescriptor.js\";\nexport default function _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = classExtractFieldDescriptor(receiver, privateMap, \"get\");\n  return classApplyDescriptorGet(receiver, descriptor);\n}","export default function _classExtractFieldDescriptor(receiver, privateMap, action) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n  }\n  return privateMap.get(receiver);\n}","export default function _classApplyDescriptorGet(receiver, descriptor) {\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n  return descriptor.value;\n}","const IntegrationsManager = class {\n  #providers = {}\n\n  callPlugin({ providerFor, providerArgs, hook, hookArgs }) {\n    const providerOptions = this.#providers[providerFor]\n    if (providerOptions === undefined) {\n      throw new Error(`No such provider class '${providerFor}'.`)\n    }\n\n    const filteredOptions = providerOptions.filter((po) => po.providerTest(providerArgs))\n    if (filteredOptions.length === 0) {\n      throw new Error(`No provider found for '${providerFor}'.`)\n    }\n    else if (filteredOptions.length > 1) {\n      throw new Error(`Ambiguous multiple providers found for '${providerFor}'.`)\n    }\n\n    const { name, hooks } = filteredOptions[0]\n    const hookFunc = hooks[hook]\n    if (hookFunc === undefined) {\n      throw new Error(`No such hook '${hook}' found for provider '${name}' (of class '${providerFor}'.`)\n    }\n\n    return hookFunc(hookArgs)\n  }\n\n  register({ hooks, name, providerFor, providerTest }) {\n    if (!(providerFor in this.#providers)) {\n      this.#providers[providerFor] = []\n    }\n    this.#providers[providerFor].push({ hooks, name, providerTest })\n  }\n}\n\nexport { IntegrationsManager }","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export * from './handlers'\nexport * from './setup'\n\nconst name = 'integrations'\nconst summary = 'Manages integration plugins.'\n\nexport { name, summary }\n","import { IntegrationsManager } from './integrations-manager'\n\nconst setup = ({ app, model, reporter }) => {\n  app.ext.integrations = new IntegrationsManager()\n}\n\nexport { setup }\n"],"names":["hostVersionRetriever","_ref","app","ext","serverVersion","pluginType","pluginsDesc","_addPluginsSetup","addPluginsSetup","help","method","parameters","pluginPkgDirRetriever","fsPath","join","LIQ_HOME","func","addPluginsHandler","installedPluginsRetriever","_ref2","integrations","listPlugins","_detailsPluginSetup","detailsPluginSetup","detailsPluginHandler","_listPluginsSetup","listPluginsSetup","listPluginsHandler","_removePluginsSetup","removePluginsSetup","removePluginsHandler","nameKey","handlers","addHandler","detailsHandler","listHandler","_typeof","o","Symbol","iterator","constructor","prototype","_toPropertyKey","arg","key","input","hint","prim","toPrimitive","undefined","res","call","TypeError","String","Number","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","toPropertyKey","_classPrivateFieldGet","receiver","privateMap","action","has","get","classExtractFieldDescriptor","value","classApplyDescriptorGet","IntegrationsManager","_providers","WeakMap","instance","Constructor","_classCallCheck","_classPrivateFieldInitSpec","protoProps","staticProps","providerFor","providerArgs","hook","hookArgs","providerOptions","this","Error","concat","filteredOptions","filter","po","providerTest","_filteredOptions$","name","hookFunc","hooks","push","model","reporter"],"mappings":"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","x_google_ignoreList":[5,6,7,8,9,10,11,13]}